---
{"dg-publish":true,"permalink":"/02.DevWiki/Sources/유니티 메인스레드/","noteIcon":""}
---

**스레드** : CPU에서 실행되는 작업의 흐름
**메인스레드** : 프로그램의 핵심적인 부분들이 실행되는 스레드

## 유니티와 메인스레드

- 유니티 메인스레드에는 렌더링, 물리연산, 게임로직 등 엔진의 핵심적인 기능들을 실행시키는 **PlayerLoop**라는 루프 명령이 돌고 있다
- 게임 로직은 메인 스레드에서 수행, 많은 연산이 필요한 부분은 멀티스레드로 위임하는것이 일반적인 사용방식
    - 유니티 메인스레드에서 무거운 작업 수행시 화면이 멈춰버릴 수 있다
        - **PlayerLoop**를 메인스레드에서 담당하기 때문이다
        - 이 때 멀티스레드에서 해당 작업을 대신 수행하게 만들면 메인스레드는 본인의 작업에 집중할 수 있다

## 유니티 API기능에 접근하는건 반드시 메인스레드에서

- **유니티 API관련 동기화는 메인스레드**에서 실행된다
- 따라서 유니티의 **게임오브젝트, 컴포넌트등 유니티 API에 접근하는 작업은 반드시 메인스레드**에서 수행해야 함
    - 그렇지 않을 경우 예기치 못한 문제가 발생할 수 있음에 주의
- `Task.Run()`등을 사용해 **멀티스레드 내에서 UnityAPI를 호출**하면 **예외가 발생**한다!

## 멀티스레드에서 UnityAPI를 실행할 수는 없을까?

### UniTask와 Awaitable

- **UniTask는 서드파티 플러그인**, **Awaitable은 유니티에서 공식적으로 지원하는 비동기 클래스**이다
    - UniTask에 대해선 [[02.DevWiki/Sources/유니티 UniTask\|유니티 UniTask]] 참고
- **Awaitable**은 유니티 2023.1 버전부터 지원
- 근데 둘다 멀티스레드에서 UnityAPI를 호출한다기 보다는 **멀티스레드에서 실행하다 일시적으로 메인스레드에 작업을 넘겨주는 쪽**에 가깝긴 하다